
extern BYTE CreateProcessW_hook[6];
extern BYTE CreateProcessA_hook[6];
extern BYTE CreateProcessW64_hook[14];
extern BYTE CreateProcessA64_hook[14];
extern BYTE jmp[6];
extern BYTE jmp64[14];




#ifndef _HOOK_H_
#define _HOOK_H_

DWORD HookFunction(LPCSTR lpModule, LPCSTR lpFuncName, LPVOID lpFunction, unsigned char *lpBackup);
BOOL UnHookFunction(LPCSTR lpModule, LPCSTR lpFuncName, unsigned char *lpBackup);
DWORD HookFunction64(LPCSTR lpModule, LPCSTR lpFuncName, LPVOID lpFunction, unsigned char *lpBackup);
BOOL UnHookFunction64(LPCSTR lpModule, LPCSTR lpFuncName, unsigned char *lpBackup);
bool bCompare(const BYTE* pData, const BYTE* bMask, const char* szMask);
BYTE * FindPattern(DWORD dwAddress, DWORD dwLen, BYTE *bMask, char * szMask);

BOOL WINAPI nCreateProcessA(LPCSTR lpApplicationName, LPSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes,
	LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment,
	LPCSTR lpCurrentDirectory, LPSTARTUPINFOA lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);
BOOL WINAPI nCreateProcessW(LPCWSTR lpApplicationName, LPWSTR lpCommandLine, LPSECURITY_ATTRIBUTES lpProcessAttributes,
	LPSECURITY_ATTRIBUTES lpThreadAttributes, BOOL bInheritHandles, DWORD dwCreationFlags, LPVOID lpEnvironment,
	LPCWSTR lpCurrentDirectory, LPSTARTUPINFOW lpStartupInfo, LPPROCESS_INFORMATION lpProcessInformation);

#endif